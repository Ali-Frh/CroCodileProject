{"name":"otouto","tagline":"The plugin-wielding, multi-purpose Telegram bot.","body":"#otouto\r\nThe plugin-wielding, multipurpose Telegram bot.\r\n\r\nThe public bot runs on [@mokubot](https://telegram.me/otouto).\r\n\r\notouto is licensed under the GNU General Public License. A copy of the license has been included in [LICENSE](https://github.com/topkecleon/otouto/blob/master/LICENSE).\r\n\r\n##What is it?\r\notouto is an independently-developed Telegram API bot written in Lua. otouto was created in February 2015, open-sourced in June, and is being augmented to this day.\r\n\r\nBot commands and functions use a comprehensive plugin system, similar to that of (yagop's telegram-bot)[github.com/yagop/telegram-bot]. The aim of the project is to host every desirable feature in one bot.\r\n\r\n##Plugins\r\nBelow are listed many (but not all) of otouto's plugins. This list will be updated as more plugins are added.\r\n\r\n###**echo.lua**\r\n\r\n>**Command:** /echo &lt;text&gt;\r\n\r\n>**Function:** Repeats a string of text.\r\n\r\n>**Notes:** Replaces letters with corresponding characters from the Cyrillic alphabet.\r\n\r\n###**gSearch.lua**\r\n\r\n>**Command:** /google [query]\r\n\r\n>**Function:** Returns four or eight Google results, depending on whether it is run in a group chat or a private message.\r\n\r\n>**Aliases:** /g, /gnsfw, /googlensfw\r\n\r\n>**Notes:** If \"nsfw\" is appended to the command, Safe Search will not be used.\r\n\r\n###**gImages.lua**\r\n\r\n>**Command:** /images [query]\r\n\r\n>**Function:** Returns a random top result from Google Image.\r\n\r\n>**Aliases:** /i, /gimages, /gnsfw\r\n\r\n>**Notes:** If \"nsfw\" is appended to the command, Safe Search and image preview will not be used.\r\n\r\n###**gMaps.lua**\r\n\r\n>**Command:** /location [query]\r\n\r\n>**Function:** Returns location data from Google Maps.\r\n\r\n>**Aliases:** /loc\r\n\r\n###**translate.lua**\r\n\r\n>**Command:** /translate [text]\r\n\r\n>**Function:** Translates the replied-to message or the given string to the configured language.\r\n\r\n###**youtube.lua**\r\n\r\n>**Command:** /youtube [query]\r\n\r\n>**Function:** Returns the top video result from YouTube.\r\n\r\n>**Aliases:** /yt\r\n\r\n###**wikipedia.lua**\r\n\r\n>**Command:** /wikipedia [query]\r\n\r\n>**Function:** Returns the top paragraph of and the link to a Wikipedia article.\r\n\r\n>**Aliases:** /wiki\r\n\r\n###**lastfm.lua**\r\n\r\n>**Command:** /lastfm\r\n\r\n>**Function**: Returns help for the last.fm actions.\r\n\r\n>**Actions**:\r\n\r\n>>**/np** [username]\r\n\r\n>>Returns the current- or last-played song for the given username. If no username is given, it will use your configured last.fm username or your Telegram username.\r\n\r\n\r\n>>**/fmset** &lt;username&gt;\r\n\r\n>>Sets your last.fm username. Use /fmset - to delete it.\r\n\r\n###**hackernews.lua**\r\n\r\n>**Command:** /hackernews\r\n\r\n>**Function:** Returns the top four or eight headlines on Hacker News, depending on whether it is run in a group chat or private message.\r\n\r\n>**Aliases:** /hn\r\n\r\n###**imdb.lua**\r\n\r\n>**Command:** /imdb &lt;query&gt;\r\n\r\n>**Function:** Returns movie information from IMDb.\r\n\r\n###**calc.lua**\r\n\r\n>**Command:** /calc &lt;expression&gt;\r\n\r\n>**Function:** Returns solutions to mathematical expressions and conversions between common units. Results provided by mathjs.org.\r\n\r\n###**bible.lua**\r\n\r\n>**Command:** /bible &lt;reference&gt;\r\n\r\n>**Function:** Returns a Bible verse. Results provided by biblia.com\r\n\r\n>**Aliases:** /b\r\n\r\n###**urbandictionary.lua**\r\n\r\n>**Command:** /urbandictionary &lt;query&gt;\r\n\r\n>**Function:** Returns the top definition from Urban Dictionary.\r\n\r\n>**Aliases:** /ud, /urban\r\n\r\n###**time.lua**\r\n\r\n>**Command:** /time &lt;query&gt;\r\n\r\n>**Function:** Returns the time, date, and timezone for a given location.\r\n\r\n###**weather.lua**\r\n\r\n>**Command:** /weather &lt;query&gt;\r\n\r\n>**Function:** Returns the current weather conditions for a given location.\r\n\r\n###**nick.lua**\r\n\r\n>**Command:** /nick &lt;nickname&gt;\r\n\r\n>**Function:** Set your nickname. Use \"/nick -\" to delete it.\r\n\r\n###**whoami.lua**\r\n\r\n>**Command:** /whoami\r\n\r\n>**Function:** Returns user and chat info for your or the replied-to message.\r\n\r\n###**8ball.lua**\r\n\r\n>**Command:** /8ball\r\n\r\n>**Function:** Returns an answer from a magic 8-ball.\r\n\r\n###**dice.lua**\r\n\r\n>**Command:** /roll &lt;nDr&gt;\r\n\r\n>**Function:** Returns RNG dice rolls. Uses D&D notation.\r\n\r\n>**Examples:**\r\n\r\n>>/roll 4D20\r\n\r\n>>/roll 6\r\n\r\n###**reddit.lua**\r\n\r\n>**Command:** /reddit [r/subreddit | query]\r\n\r\n>**Function:** Returns the top four or eight results, depending on whether it is run in a group chat or private message, from a given subreddit, query, or r/all.\r\n\r\n>**Aliases:** /r\r\n\r\n>**Notes:** You may also get results for a subreddit by entering \"/r/subreddit\".\r\n\r\n>**Examples:**\r\n\r\n>> /reddit zelda\r\n\r\n>> /reddit r/gaming\r\n\r\n>>/r/talesfromtechsupport\r\n\r\n###**xkcd.lua**\r\n\r\n>**Command:** /xkcd [query]\r\n\r\n>**Function:** Returns an xkcd strip and it's alt text. If not query is given, it will use a random strip.\r\n\r\n###**slap.lua**\r\n\r\n>**Command:** /slap &lt;target&gt;\r\n\r\n>**Function:** Give someone a good slap (or worse).\r\n\r\n###**commit.lua**\r\n\r\n>**Command:** /commit\r\n\r\n>**Function:** Returns a commit message from whatthecommit.com.\r\n\r\n###**fortune.lua**\r\n\r\n>**Command:** /fortune\r\n\r\n>**Function:** Returns a UNIX fortune.\r\n\r\n###**pun.lua**\r\n\r\n>**Command:** /pun\r\n\r\n>**Function:** Returns a pun.\r\n\r\n###**pokedex.lua**\r\n\r\n>**Command:** /pokedex &lt;query&gt;\r\n\r\n>**Function:** Returns a Pokedex entry.\r\n\r\n>**Aliases:** /dex\r\n\r\n###**currency.lua**\r\n\r\n>**Command:** /cash [amount] &lt;from&gt; to &lt;from&gt;\r\n\r\n>**Function:** Converts an amount of one currency to another.\r\n\r\n>**Examples:**\r\n\r\n>>/cash 5 USD to EUR\r\n\r\n>>/cash BTC to GBP\r\n\r\n###**cats.lua**\r\n\r\n>**Command:** /cat\r\n\r\n>**Function:** Returns a cat pic.\r\n\r\n###**admin.lua**\r\n\r\n>**Command:** /admin [command]\r\n\r\n>**Function:** Runs an admin command or returns a list of them.\r\n\r\n>**Notes:** Only usable by the configured admin.\r\n\r\n###**blacklist.lua**\r\n\r\n>**Command:** /blacklist [id]\r\n\r\n>**Function:** Blacklists or unblacklists the specified ID or replied-to user.\r\n\r\n>**Notes:** Only usable by the configured admin.\r\n\r\n##Liberbot Plugins\r\nSome plugins are only useful when the bot is used in a Liberbot group: moderation.lua, antisquig.lua, floodcontrol.lua.\r\n\r\nfloodcontrol.lua makes the bot compliant to Liberbot's bot floodcontrol. It should prevent your bot from being globally banned from Liberbot groups.\r\n\r\nmoderation.lua allows realm administrators to assign moderators for a group. This only works if the bot is made a realm administrator.\r\n\r\nYou must configure this plugin in the \"moderation\" section of config.lua, in the following way:\r\n\r\n```\r\nmoderation = {\r\n\tadmins = {\r\n\t\t['123456789'] = 'Adam',\r\n\t\t['1337420'] = 'Eve'\r\n\t},\r\n\tadmin_group = -8675309,\r\n\trealm_name = 'My Realm'\r\n}\r\n```\r\n\r\nWhere Adam and Eve are realm administrators, and their IDs are set as the keys in the form of strings. admin_group is the ID, a negative number, of the realm administration group. realm_name is the name as a string.\r\n\r\nOnce this is set up, put the bot in the admin group and run /add and /modlist to get started.\r\n\r\nantisquig.lua is an extension to moderation.lua. It will automatically kick a user who posts Arabic script.\r\n\r\n##Other Plugins\r\nThere are other plugins not listed above: help.lua, about.lua, chatter.lua, greetings.lua.\r\n\r\nhelp.lua is self-explanatory. When the plugin loads, it compiles a list of commands, and will return them.\r\n\r\nabout.lua returns the content of the about_text string in config.lua.\r\n\r\nchatter.lua will let the user interact with a chatterbot, if he replies to a message sent by the bot.\r\n\r\ngreetings.lua is where things get tricky. It allows the bot to respond to several greetings with a preconfigured response. This is configured in the \"greetings\" section of config.lua:\r\n\r\n```\r\ngreetings = {\r\n\t['Hello, #NAME.'] = {\r\n\t\t'hello',\r\n\t\t'hey',\r\n\t\t'hi'\r\n\t},\r\n\t['Goodbye, #NAME.'] = {\r\n\t\t'goodbye',\r\n\t\t'bye',\r\n\t}\r\n}\r\n```\r\n\r\nWhere the key is the preconfigured response (where #NAME will be replaced with the user's name or nickname) and the strings in the table are the expected greetings (followed by the bot's name and possible punctuation).\r\n\r\n##Setup\r\nYou **must** have lua-socket and lua-sec installed. For uploading photos and other files, you must have curl installed. The fortune.lua plugin requires that fortune is installed.\r\n\r\nFor weather.lua, lastfm.lua, and bible.lua to work, you must have API keys for openweathermap.org, last.fm, and biblia.com, respectively. cats.lua uses an API key to get more results, though it is not required.\r\n\r\n>**Before you do anything, edit config.lua and make the following changes:**\r\n\r\n>* Edit bot_api_key with your authentication token from Botfather.\r\n>* Set admin as your Telegram ID as a number.\r\n\r\nYou may also want to set your time_offset (a positive or negative number, in seconds, representing your computer's difference from UTC), your lang (lowercase, two-letter code representing your language), and modify your about_text. Some plugins will not be enabled by default, as they are for specific uses. If you want to use them, add them to the plugins table.\r\n\r\nTo start the bot, run\r\n\r\n`./launch.sh`\r\n\r\nTo stop the bot, press Ctrl+C twice.\r\n\r\nYou may also start the bot manually with\r\n\r\n`lua bot.lua`\r\n\r\nthough that will not cause it to automatically restart.\r\n\r\n##Support\r\nDo not contact me through private messages for support.\r\n\r\nFor otouto, bot, and other Lua support in general, join the Bot Development group. Send \"/join 16314802\" to [@Liberbot](https://telegram.me/liberbot). If this does not work the first time, you may need to send it up to seven more times, thanks to Telegram's automatic spam-prevention mechanism.\r\n\r\n##Development\r\nEveryone is free to contribute to otouto. If you would like to write a plugin, here I will lay out various things that are important to know about the plugin system.\r\n\r\nEvery plugin has four components, and half of them are optional: action, triggers, doc, cron.\r\n\r\ntriggers is a table of strings using Lua patterns which, when matched by a message's text, will \"trigger\" the action function. This is not optional.\r\n\r\naction is the main function of a plugin. It accepts the \"msg\" table, which is all the components of the message, as an argument. This is not optional.\r\n\r\ndoc is the documentation. The first line is the expected command and arguments. Arguments in square braces are considered optional and those in angled braces are considered required. This is optional.\r\n\r\ncron is a function run every five seconds. This is optional.\r\n\r\nThe on_msg_receive function adds a few variables to the \"msg\" table: msg.from.id_str, msg.to.id_str, msg.text_lower. These are self-explanatory and make code a lot neater.\r\n\r\nReturn values from the action function are optional, but when they are used, they determine the fate of the message. When false/nil is returned, on_msg_receive stops and the script moves on to waiting for the next message. When true is returned, on_msg_receive continues going through the plugins for a match. When a table is returned, that table becomes the \"msg\" table, and on_msg_receive continues.\r\n\r\nWhen a plugin action or cron function fails, the script will catch the error and print it, and, if applicable, the text which triggered the plugin, and continue.\r\n\r\n----\r\n\r\nInteractions with the Telegram bot API are straightforward. Every function is named the same as the API method it utilizes. The order of expected arguments is laid out in bindings.lua.\r\n\r\nThere are three functions which are not API methods: sendRequest, curlRequest, and sendReply. The first two are used by the other functions. sendReply is used directly. It expects the \"msg\" table as its first argument, and a string of text as its second. It will send a reply without image preview to the initial message.\r\n\r\n----\r\n\r\nSeveral functions and methods used by multiple plugins and possibly the main script are kept in utilities.lua. Refer to that file for documentation.\r\n\r\n----\r\n\r\notouto uses dkjson, a pure-Lua JSON parser. This is provided with the code and does not need to be downloaded or installed separately.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}